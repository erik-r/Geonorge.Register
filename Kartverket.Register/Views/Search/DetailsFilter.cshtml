@model Kartverket.Register.Models.Register
﻿@using Kartverket.Register.Helpers
@using PagedList;


@{
    ViewBag.Title = Model.name;
    var owner = ViewBag.owner;
    var logo = ViewBag.ownerLogo;
    var ownerSEO = ViewBag.ownerSEO;
    var register = ViewBag.register;
}

@section breadcrumb {
    <li><a href="/register/@Model.seoname">@Html.DisplayFor(model => model.name)</a></li>
    <li class="active">@owner</li> 
}

<script>
    function SortBy(sort) {
        var sort = document.getElementById("sorting");
        var selected = sort.options[sort.selectedIndex].text;
        document.sortering.submit();
        localStorage['SortingType'] = selected;
    }
</script>

<div class="page-header">
    <h2 class="h-md">@Html.DisplayFor(model => model.name)</h2>
    <hr>
</div>

<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <div class="col-no-padding-xs col-xs-12 col-sm-9 col-md-9 col-lg-9">

        ID: <a href="/register/@ownerSEO">http://@Request.Url.Host@Request.Url.LocalPath </a>
        <img src="@Url.Content("~/data/organizations/" + @logo)" class="img-responsive img-small-logo" alt="@owner" />
    </div>

    <div class="col-no-padding-xs col-xs-12 col-sm-3 col-md-3 col-lg-3">
        <span class="small">Registrert: @Html.DisplayFor(model => model.dateSubmitted)</span><br />
        <span class="small">Oppdatert: @Html.DisplayFor(model => model.modified)</span>

    </div>

    @{
        var page = ViewBag.page;
        var currentFilter = ViewBag.currentFilter;
        var sortering = Model.items.OrderBy(o => o.name).ToList();
        int pageSize = 50;
        int pageNumber = (page ?? 1);

        if (ViewBag.SortOrder == "name_desc")
        {
            sortering = Model.items.OrderBy(o => o.register.name).ToList();
        }
        if (ViewBag.SortOrder == "submitter")
        {
            sortering = Model.items.OrderBy(o => o.submitter.name).ToList();
        }
        if (ViewBag.SortOrder == "submitter_desc")
        {
            sortering = Model.items.OrderByDescending(o => o.submitter.name).ToList();
        }
        else if (ViewBag.SortOrder == "status")
        {
            sortering = Model.items.OrderBy(o => o.status.description).ToList();
        }
        else if (ViewBag.SortOrder == "status_desc")
        {
            sortering = Model.items.OrderByDescending(o => o.status.description).ToList();
        }
        else if (ViewBag.SortOrder == "dateSubmitted")
        {
            sortering = Model.items.OrderBy(o => o.dateSubmitted).ToList();
        }
        else if (ViewBag.SortOrder == "dateSubmitted_desc")
        {
            sortering = Model.items.OrderByDescending(o => o.dateSubmitted).ToList();
        }
        else if (ViewBag.SortOrder == "modified")
        {
            sortering = Model.items.OrderBy(o => o.modified).ToList();
        }
        else if (ViewBag.SortOrder == "modified_desc")
        {
            sortering = Model.items.OrderByDescending(o => o.modified).ToList();
        }
        else if (ViewBag.SortOrder == "dateAccepted")
        {
            sortering = Model.items.OrderBy(o => o.dateAccepted).ToList();
        }
        else if (ViewBag.SortOrder == "dateAccepted_desc")
        {
            sortering = Model.items.OrderByDescending(o => o.dateAccepted).ToList();
        }
    }



    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class=" page-header">
            <hr>
        </div>

        @if (Model.containedItemClass == "Document")
        {
            @Html.Partial("_filterDocument", sortering.ToPagedList(pageNumber, pageSize))
        }
        @if (Model.containedItemClass == "Dataset")
        {
            @Html.Partial("_filterDataset", sortering.ToPagedList(pageNumber, pageSize))
        }

    </div>
</div>

<hr />
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <a href="/register/@register/">Tilbake</a>
</div>





