@model PagedList.IPagedList<RegisterItem>
﻿@using Kartverket.Register.Helpers
@using Kartverket.Register.Models

@{
    CodelistValue selectedMunicipal = HtmlHelperExtensions.GetSelectedMunicipality(ViewBag.selectedMunicipality);
    var selectedMunicipalName = "Velg kommune";
    if (selectedMunicipal != null)
    {
        selectedMunicipalName = selectedMunicipal.name;
    }
}
<div class="col-sm-12 col-md-6 col-lg-6">
    <h2>@HtmlHelperExtensions.selectedMunicipalName(selectedMunicipal)</h2>
</div>
<div class="col-sm-12 col-md-6 col-lg-6 no-padding">
    <form action="@Request.Url.LocalPath" name="FilterForm" method="get" class="col-md-6" style="margin-top: 38px; float: right;">
        <div class="save-as-dropdown">
            <div class="sorter pagination">
                Velg kommune:
                <div class="custom-select">
                    @Html.DropDownList("municipality", new SelectList(ViewBag.municipality, "value", "name"), selectedMunicipalName, new { @class = "form-control", onchange = "this.form.submit()" })
                </div>
            </div>
        </div>
    </form>
</div>
@if (selectedMunicipal != null || HtmlHelperExtensions.IsAdmin())
{
    <table class="table-responsive table-hover table" style="width:100%">
        <tbody>
            <tr>
                <th style="width:10%">Temagruppe</th>
                <th style="width:20%">Tittel</th>
                <th style="width:20%">Eier</th>
                <th style="width:10%">DOK-status</th>
                <th style="width:10%">Nasjonalt/ <br />Kommunalt</th>
                <th style="width:10%">Bekreftet</th>
                <th style="width:20%">Merknad</th>
            </tr>
            @foreach (Dataset item in Model)
                {
                <tr>
                    <td title="Temagruppe for @item.name: @item.theme.description">@item.theme.description</td>
                    <td title="Datasett: @item.name">
                        <a href="@item.GetObjectUrl()">
                            @item.name
                        </a>
                    </td>
                    <td title="Datasett eier: @item.datasetowner.seoname">
                        @item.datasetowner.name
                    </td>
                    <td title="Dok-status: @HtmlHelperExtensions.GetDokStatusFromCoverage(item, selectedMunicipal)">
                        @HtmlHelperExtensions.GetDokStatusFromCoverage(item, selectedMunicipal)
                    </td>
                    <td title="Datasett type: @item.DatasetType">@item.DatasetType</td>
                    <td style="text-align: center" title="Bekrefter: @HtmlHelperExtensions.GetConfirmedFromCoverage(item, selectedMunicipal))">
                        @HtmlHelperExtensions.GetConfirmedFromCoverage(item, selectedMunicipal)
                    </td>
                    <td title="Merknad: @HtmlHelperExtensions.GetNoteFromCoverage(item, selectedMunicipal)">
                        @HtmlHelperExtensions.GetNoteFromCoverage(item, selectedMunicipal)
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
