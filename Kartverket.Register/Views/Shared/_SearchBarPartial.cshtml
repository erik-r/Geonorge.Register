﻿@using Kartverket.Register.Helpers

<script>
    function registerName(reg) {
        document.getElementById("register").value = reg;
        document.getElementById("registerSelected").innerHTML = reg;
    }

</script>

@{
    var kontroller = "/search/";

    if (ViewBag.registerSEO != null)
    {
        kontroller = Request.Url.LocalPath; // "/register/" + ViewBag.registerSEO + "/";    
    }
    
    var searchRegister = ViewBag.searchRegister;
    var register = ViewBag.register;

    if (searchRegister != null)
    {
        register = ViewBag.searchRegister;  
    }
    else { 
        if (register == null)
        { 
            register = "Alle registre";
        } 
    }

    
}



<form action="@kontroller" class="col-md-offset-2 col-md-8 hidden-print">

    <input type="hidden" id="register" name="register" value="@(Request.QueryString["register"] != null ? Request.QueryString["register"].ToString() : @register)" />

    <h3 class="h-md" id="register-heading">Søk i register</h3>
    <div class="input-group input-group-split-on-xs edgesRegistre">
        @*Set edges* class for borders according to dropdown choice*@
        <div class="input-group-btn">
            <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                <span id="registerSelected">@register</span>
                <span class="caret"></span>
            </button>
            <ul class="geonorge-dropdown dropdown-menu" id="SearchRegister" tabindex="-1">

                <li tabindex="0" onclick="registerName('Alle registre')" class="left-edge-registre"><a href="@Html.RegistryUrl()">Alle registre</a></li>
                <li tabindex="0" onclick="registerName('Objektregisteret')" class="left-edge-registre"><a href="@Html.ObjektkatalogUrl()">Objektregisteret</a></li>

                @foreach (var item in HtmlHelperExtensions.Registers().OrderBy(r => r.name))
                {
                    <li tabindex="0" onclick="registerName('@item.name')" class="left-edge-registre"><a href="@Html.RegistryUrl()register/@item.seoname">@item.name</a></li>
                }
            </ul>
        </div><!-- /input-group-btn -->
        <input name="text" style="z-index: 0;" type="text" placeholder="Søk etter registerdata" title="Søk" class="form-control" id="txtSearch" value="@(Request.QueryString["text"] != null ? Request.QueryString["text"].ToString() : "")" />
        <span class="input-group-btn">
            <button class="btn" type="submit" style="z-index: 0;">Søk</button>
        </span>
    </div>
</form>

@*Request.QueryString["register"] != null ? Request.QueryString["register"].ToString()*@